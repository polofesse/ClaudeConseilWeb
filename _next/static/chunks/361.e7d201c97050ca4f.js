"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[361],{30361:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var i=n(85893),a=n(964);let r=a.ZP.div.withConfig({componentId:"sc-21247cad-0"})(["display:flex;place-content:center;canvas{background-color:#000;height:100%;width:100%;}"]);var o=n(67294),s=n(81338),c=n(78743),l=n(12691),u=n(26550),f=n(27972),w=({containerRef:e,id:t,setLoading:n,loading:i})=>{let{processes:{[t]:r}={}}=(0,c.z)(),{componentWindow:w,defaultSize:d={height:0,width:0},libs:h=[],maximized:m=!1}=r||{},{windowStates:{[t]:v}}=(0,l.k)(),{sizes:{titleBar:b}}=(0,a.Fg)(),p=(0,o.useRef)(!1),y=(0,s.Z)(),{size:g}=v||{};(0,o.useEffect)(()=>{i&&(0,f.mb)(h).then(()=>{window.ioq3&&(window.ioq3.viewport=e.current,window.ioq3.elementPointerLock=!0,window.ioq3.callMain([]),n(!1),y(window.FS,"Quake3"))})},[e,h,i,y,n]),(0,o.useEffect)(()=>{window.ioq3&&setTimeout(()=>{p.current=m;let{height:e,width:t}=!m&&g||w?.getBoundingClientRect()||{};if(!e||!t)return;let n=d?(0,f.Vy)(d.width)/(0,f.Vy)(d.height):4/3,i=(0,f.Vy)(t),a=i>(0,f.Vy)(e)-b.height,r=m&&a?i/n:i,o=r/n;o>0&&r>0&&window.ioq3?.canvas&&(window.ioq3.setCanvasSize(r,o),window.ioq3.canvas.setAttribute("style",`object-fit: ${a?"contain":"scale-down"}`))},m||p.current?u.jx.WINDOW+10:0)},[w,d,m,g,b.height]),(0,o.useEffect)(()=>()=>{try{window.ioq3?.exit()}catch{}window.AL?.contexts.forEach(({ctx:e})=>e.close())},[])},d=n(50834),h=({id:e})=>(0,i.jsx)(d.Z,{StyledComponent:r,id:e,useHook:w})},50834:function(e,t,n){var i=n(85893),a=n(5152),r=n.n(a),o=n(67294),s=n(54944),c=n(78743);let l=r()(()=>n.e(446).then(n.bind(n,60446)),{loadableGenerated:{webpack:()=>[60446]}});t.Z=(0,o.memo)(({id:e,useHook:t,StyledComponent:n,children:a})=>{let{processes:{[e]:{url:r=""}={}}}=(0,c.z)(),u=(0,o.useRef)(null),[f,w]=(0,o.useState)(!0),d=(0,o.useMemo)(()=>({contain:"strict",visibility:f?"hidden":"visible"}),[f]);return t({containerRef:u,id:e,loading:f,setLoading:w,url:r}),(0,i.jsxs)(i.Fragment,{children:[f&&(0,i.jsx)(l,{}),(0,i.jsx)(n,{ref:u,style:d,...(0,s.Z)({id:e}),children:a})]})})},81338:function(e,t,n){var i=n(67294),a=n(59140);t.Z=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,a.o)(),r=(0,i.useRef)();return(0,i.useEffect)(()=>()=>{if(r.current){let e=r.current;r.current="",t(e,!0).then(()=>n("/",void 0,e)).catch(()=>{})}},[t,n]),(0,i.useCallback)(async(t,i)=>{if(!t)return;let a="";try{a=await e(t,i)}catch{}a&&(n("/",a),r.current=a)},[e,n])}},54944:function(e,t,n){var i=n(1864),a=n(67294),r=n(46013),o=n(36094),s=n(41893),c=n(59140),l=n(78743),u=n(12691),f=n(26550),w=n(27972);t.Z=({callback:e,directory:t=f.Ll,id:n,onDragLeave:d,onDragOver:h,updatePositions:m})=>{let{url:v}=(0,l.z)(),{iconPositions:b,sortOrders:p,setIconPositions:y}=(0,u.k)(),{mkdirRecursive:g,updateFolder:k,writeFile:x}=(0,c.o)(),E=(0,a.useCallback)(async(e,t,a)=>{if(n){if(t){let r=(0,i.join)(f.Ll,e);if(await g(f.Ll),await x(r,t,!0))return a===s.v.UPDATE_URL&&v(n,r),k(f.Ll,e),(0,i.basename)(r)}else a===s.v.UPDATE_URL&&v(n,e)}return""},[n,g,k,v,x]),{openTransferDialog:L}=(0,r.Z)();return{onDragLeave:d,onDragOver:e=>{h?.(e),(0,w.nK)(e)},onDrop:a=>{if(!f.my.has((0,w.RT)(t))){if(m&&a.target instanceof HTMLElement){let{files:e,text:n}=(0,o.p4)(a);if(0===e.length&&""===n)return;let r={x:a.clientX,y:a.clientY},s=[];if(n){try{s=JSON.parse(n)}catch{}if(!Array.isArray(s))return;let[e]=s;if(!e||e.startsWith(t)&&(0,i.basename)(e)===(0,i.relative)(t,e))return;s=s.map(e=>(0,i.basename)(e))}else s=e instanceof FileList?[...e].map(e=>e.name):[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);s=s.map(e=>{if(!b[`${t}/${e}`])return e;let n=0,a="";do n+=1,a=`${t}/${(0,i.basename)(e,(0,i.extname)(e))} (${n})${(0,i.extname)(e)}`;while(b[a]);return(0,i.basename)(a)}),(0,w.vi)(t,a.target,b,p,r,s,y)}(0,o.WG)(a,e||E,t,L,!!n)}}}}}}]);